const APP_CACHE="app-shell-v1",RUNTIME_CACHE="runtime-v1",BASE=(self.registration?.scope||"/").replace(location.origin,""),APP_SHELL=[`${BASE}`,`${BASE}index.html`,`${BASE}bundle.js`,"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css","https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",`${BASE}manifest.webmanifest`,`${BASE}icons/icon-192.png`,`${BASE}icons/icon-512.png`];self.addEventListener("install",t=>{t.waitUntil((async()=>{const t=await caches.open(APP_CACHE);await t.addAll(APP_SHELL),self.skipWaiting()})())}),self.addEventListener("activate",t=>{t.waitUntil((async()=>{const t=await caches.keys();await Promise.all(t.map(t=>t!==APP_CACHE&&"runtime-v1"!==t?caches.delete(t):null)),self.clients.claim()})())}),self.addEventListener("fetch",t=>{const{request:e}=t;"GET"===e.method&&(e.url.includes("/v1/stories")?t.respondWith((async()=>{try{const t=await fetch(e);return(await caches.open("runtime-v1")).put(e,t.clone()),t}catch{const t=await caches.open("runtime-v1");return await t.match(e)||new Response(JSON.stringify({error:!0,message:"offline"}),{headers:{"Content-Type":"application/json"}})}})()):"navigate"!==e.mode?t.respondWith((async()=>{const t=await caches.open("runtime-v1"),a=await t.match(e),n=fetch(e).then(a=>(t.put(e,a.clone()),a)).catch(()=>a);return a||n})()):t.respondWith((async()=>{try{const t=await fetch(e);return(await caches.open(APP_CACHE)).put(`${BASE}`,t.clone()),t}catch{const t=await caches.open(APP_CACHE);return await t.match(`${BASE}index.html`)||await t.match("index.html")}})()))});